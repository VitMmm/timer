<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>–¢–∞–π–º–µ—Ä –∑–∞–¥–∞—á</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 20px;
      }

      .container {
        max-width: 800px;
        margin: 0 auto;
      }

      h1 {
        color: white;
        text-align: center;
        margin-bottom: 30px;
        font-size: 2.5em;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
      }

      .add-task-form {
        background: white;
        padding: 25px;
        border-radius: 15px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        margin-bottom: 30px;
      }

      .settings-panel {
        background: white;
        padding: 15px 25px;
        border-radius: 15px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        margin-bottom: 20px;
        display: flex;
        gap: 10px;
        align-items: center;
        flex-wrap: wrap;
      }

      .settings-panel button {
        padding: 10px 20px;
        font-size: 14px;
      }

      .file-status {
        color: #666;
        font-size: 14px;
        margin-left: auto;
      }

      .settings-form {
        display: flex;
        gap: 10px;
        align-items: center;
        flex-wrap: wrap;
        flex: 1;
      }

      .settings-form input {
        flex: 1;
        min-width: 200px;
        padding: 8px 12px;
        border: 2px solid #e0e0e0;
        border-radius: 8px;
        font-size: 14px;
      }

      .settings-form input:focus {
        outline: none;
        border-color: #667eea;
      }

      .save-status {
        color: #48bb78;
        font-size: 12px;
        font-style: italic;
      }

      .form-group {
        display: flex;
        gap: 10px;
      }

      input[type='text'] {
        flex: 1;
        padding: 12px 15px;
        border: 2px solid #e0e0e0;
        border-radius: 8px;
        font-size: 16px;
        transition: border-color 0.3s;
      }

      input[type='text']:focus {
        outline: none;
        border-color: #667eea;
      }

      button {
        padding: 12px 25px;
        background: #667eea;
        color: white;
        border: none;
        border-radius: 8px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s;
      }

      button:hover {
        background: #5568d3;
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
      }

      button:active {
        transform: translateY(0);
      }

      .tasks-list {
        display: flex;
        flex-direction: column;
        gap: 15px;
        margin-bottom: 30px;
      }

      .task-item {
        background: white;
        padding: 20px;
        border-radius: 15px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        transition: transform 0.2s;
      }

      .task-item:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
      }

      .task-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 15px;
      }

      .task-main-info {
        flex: 1;
        display: flex;
        flex-direction: column;
        gap: 8px;
      }

      .task-info {
        flex: 1;
        display: flex;
        flex-direction: column;
        gap: 8px;
      }

      .subtimers-section {
        margin-top: 15px;
        padding-top: 15px;
        border-top: 2px solid #f0f0f0;
      }

      .subtimers-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 10px;
      }

      .subtimers-title {
        font-size: 14px;
        font-weight: 600;
        color: #666;
      }

      .btn-add-subtimer {
        padding: 6px 12px;
        font-size: 12px;
        background: #667eea;
      }

      .btn-add-subtimer:hover {
        background: #5568d3;
      }

      .subtimers-list {
        display: flex;
        flex-direction: column;
        gap: 10px;
      }

      .subtimer-item {
        background: #f8f9fa;
        padding: 12px;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 10px;
      }

      .subtimer-info {
        flex: 1;
        display: flex;
        align-items: center;
        gap: 15px;
      }

      .subtimer-name {
        font-size: 14px;
        color: #333;
        min-width: 120px;
      }

      .subtimer-time {
        font-size: 18px;
        font-weight: 700;
        color: #764ba2;
        font-variant-numeric: tabular-nums;
        min-width: 70px;
      }

      .subtimer-actions {
        display: flex;
        gap: 8px;
      }

      .subtimer-btn {
        padding: 6px 12px;
        font-size: 12px;
      }

      .subtimer-input {
        padding: 6px 10px;
        border: 2px solid #e0e0e0;
        border-radius: 6px;
        font-size: 14px;
        flex: 1;
        max-width: 200px;
      }

      .subtimer-input:focus {
        outline: none;
        border-color: #667eea;
      }

      .payment-block {
        background: white;
        padding: 25px;
        border-radius: 15px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        margin-bottom: 30px;
      }

      .payment-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 20px;
        padding-bottom: 15px;
        border-bottom: 2px solid #f0f0f0;
      }

      .payment-title {
        font-size: 24px;
        font-weight: 700;
        color: #333;
      }

      .payment-stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-bottom: 20px;
      }

      .payment-stat-card {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        padding: 20px;
        border-radius: 12px;
        color: white;
      }

      .payment-stat-label {
        font-size: 14px;
        opacity: 0.9;
        margin-bottom: 8px;
      }

      .payment-stat-value {
        font-size: 28px;
        font-weight: 700;
        font-variant-numeric: tabular-nums;
      }

      .payment-stat-unpaid {
        background: linear-gradient(135deg, #f56565 0%, #e53e3e 100%);
      }

      .payment-stat-paid {
        background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
      }

      .archive-block {
        background: white;
        padding: 25px;
        border-radius: 15px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        margin-bottom: 30px;
      }

      .archive-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 20px;
        padding-bottom: 15px;
        border-top: 2px solid #f0f0f0;
        padding-top: 15px;
      }

      .archive-title {
        font-size: 24px;
        font-weight: 700;
        color: #333;
      }

      .archive-toggle-btn {
        background: #667eea;
        padding: 10px 20px;
        font-size: 14px;
      }

      .archive-toggle-btn:hover {
        background: #5568d3;
      }

      .archive-list {
        display: flex;
        flex-direction: column;
        gap: 15px;
      }

      .btn-archive {
        background: #ed8936;
        padding: 8px 15px;
        font-size: 14px;
      }

      .btn-archive:hover {
        background: #dd6b20;
      }

      .btn-unarchive {
        background: #4299e1;
        padding: 8px 15px;
        font-size: 14px;
      }

      .btn-unarchive:hover {
        background: #3182ce;
      }

      .payment-rate {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 20px;
        padding: 15px;
        background: #f8f9fa;
        border-radius: 8px;
      }

      .usdt-rate {
        font-size: 16px;
        color: #666;
      }

      .usdt-rate-value {
        font-weight: 700;
        color: #667eea;
      }

      .additional-payments {
        margin-top: 20px;
        padding-top: 20px;
        border-top: 2px solid #f0f0f0;
      }

      .additional-payments-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 15px;
      }

      .additional-payments-title {
        font-size: 18px;
        font-weight: 600;
        color: #333;
      }

      .additional-payments-list {
        display: flex;
        flex-direction: column;
        gap: 10px;
        margin-bottom: 15px;
      }

      .additional-payment-item {
        background: #f8f9fa;
        padding: 15px;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 15px;
      }

      #timerPaymentsList .additional-payment-item {
        gap: 0;
      }

      .additional-payment-info {
        flex: 1;
        display: flex;
        flex-direction: column;
        gap: 5px;
      }

      .additional-payment-name {
        font-size: 16px;
        font-weight: 600;
        color: #333;
      }

      .additional-payment-date {
        font-size: 12px;
        color: #38a169;
      }

      .additional-payment-amount {
        font-size: 20px;
        font-weight: 700;
        color: #48bb78;
        font-variant-numeric: tabular-nums;
      }

      .btn-paid {
        background: #48bb78;
        padding: 8px 15px;
        font-size: 14px;
      }

      .btn-paid:hover {
        background: #38a169;
      }

      .btn-unpaid {
        background: #f56565;
        padding: 8px 15px;
        font-size: 14px;
      }

      .btn-unpaid:hover {
        background: #e53e3e;
      }

      .task-paid-badge {
        display: inline-block;
        padding: 4px 10px;
        border-radius: 12px;
        font-size: 12px;
        font-weight: 600;
        margin-left: 10px;
      }

      .task-paid-badge.paid {
        background: #48bb78;
        color: white;
      }

      .task-paid-badge.unpaid {
        background: #f56565;
        color: white;
      }

      .task-name {
        font-size: 18px;
        font-weight: 600;
        color: #333;
      }

      .filter-btn {
        transition: all 0.3s;
        border: 2px solid transparent;
      }

      .filter-btn.active {
        background: #667eea;
        color: white;
        border-color: #667eea;
        font-weight: 600;
      }

      .filter-btn:not(.active) {
        background: #f0f0f0;
        color: #666;
      }

      .filter-btn:not(.active):hover {
        background: #e0e0e0;
      }

      .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.5);
        z-index: 1000;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .modal-content {
        background: white;
        padding: 30px;
        border-radius: 15px;
        max-width: 500px;
        width: 90%;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        animation: modalSlideIn 0.3s ease-out;
      }

      @keyframes modalSlideIn {
        from {
          transform: translateY(-50px);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }

      .modal-title {
        font-size: 24px;
        font-weight: 700;
        color: #333;
        margin-bottom: 20px;
      }

      .modal-input {
        width: 100%;
        padding: 12px 15px;
        border: 2px solid #e0e0e0;
        border-radius: 8px;
        font-size: 16px;
        margin-bottom: 15px;
        transition: border-color 0.3s;
      }

      .modal-input:focus {
        outline: none;
        border-color: #667eea;
      }

      .modal-buttons {
        display: flex;
        gap: 10px;
        margin-top: 20px;
      }

      .modal-button {
        flex: 1;
        padding: 12px 20px;
        border: none;
        border-radius: 8px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s;
      }

      .modal-button-primary {
        background: #667eea;
        color: white;
      }

      .modal-button-primary:hover {
        background: #5568d3;
      }

      .modal-button-secondary {
        background: #a0aec0;
        color: white;
      }

      .modal-button-secondary:hover {
        background: #718096;
      }

      .toast {
        position: fixed;
        top: 20px;
        right: 20px;
        background: white;
        padding: 15px 20px;
        border-radius: 8px;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
        z-index: 2000;
        animation: toastSlideIn 0.3s ease-out;
        display: flex;
        align-items: center;
        gap: 10px;
        max-width: 400px;
      }

      .toast.error {
        border-left: 4px solid #f56565;
      }

      .toast.success {
        border-left: 4px solid #48bb78;
      }

      .toast.info {
        border-left: 4px solid #667eea;
      }

      @keyframes toastSlideIn {
        from {
          transform: translateX(400px);
          opacity: 0;
        }
        to {
          transform: translateX(0);
          opacity: 1;
        }
      }

      .toast-icon {
        font-size: 20px;
      }

      .toast-message {
        flex: 1;
        font-size: 14px;
        color: #333;
        line-height: 1.5;
      }

      .task-time {
        font-size: 24px;
        font-weight: 700;
        color: #667eea;
        font-variant-numeric: tabular-nums;
      }

      .task-actions {
        display: flex;
        gap: 10px;
        align-items: center;
      }

      .btn-start {
        background: #48bb78;
      }

      .btn-start:hover {
        background: #38a169;
      }

      .btn-stop {
        background: #f56565;
      }

      .btn-stop:hover {
        background: #e53e3e;
      }

      .btn-delete {
        background: #a0aec0;
        padding: 8px 15px;
        font-size: 14px;
      }

      .btn-delete:hover {
        background: #718096;
      }

      .empty-state {
        text-align: center;
        color: white;
        padding: 40px;
        font-size: 18px;
        opacity: 0.9;
      }

      @media (max-width: 600px) {
        .task-header {
          flex-direction: column;
          align-items: flex-start;
          gap: 15px;
        }

        .task-actions {
          width: 100%;
          justify-content: space-between;
        }

        .form-group {
          flex-direction: column;
        }

        .subtimer-item {
          flex-direction: column;
          align-items: flex-start;
        }

        .subtimer-actions {
          width: 100%;
          justify-content: space-between;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>‚è±Ô∏è –¢–∞–π–º–µ—Ä –∑–∞–¥–∞—á</h1>

      <div class="settings-panel">
        <button id="settingsBtn">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
        <button id="reloadBtn" style="display: none">üîÑ –û–±–Ω–æ–≤–∏—Ç—å –∏–∑ GitHub</button>
        <div class="file-status" id="fileStatus">–ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ç–∫–ª—é—á–µ–Ω–æ</div>
        <div class="save-status" id="saveStatus" style="display: none"></div>
      </div>

      <div id="settingsModal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.5); z-index: 1000; align-items: center; justify-content: center">
        <div style="background: white; padding: 30px; border-radius: 15px; max-width: 500px; width: 90%; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3)">
          <h2 style="margin-bottom: 20px; color: #333">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ GitHub</h2>
          <div class="settings-form" style="flex-direction: column; align-items: stretch">
            <label style="margin-bottom: 5px; color: #666; font-size: 14px">GitHub —Ç–æ–∫–µ–Ω (Personal Access Token):</label>
            <input type="password" id="githubToken" placeholder="ghp_xxxxxxxxxxxx" />
            <label style="margin-top: 15px; margin-bottom: 5px; color: #666; font-size: 14px">–í–ª–∞–¥–µ–ª–µ—Ü —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:</label>
            <input type="text" id="repoOwner" placeholder="username" />
            <label style="margin-top: 15px; margin-bottom: 5px; color: #666; font-size: 14px">–ù–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:</label>
            <input type="text" id="repoName" placeholder="repository-name" />
            <label style="margin-top: 15px; margin-bottom: 5px; color: #666; font-size: 14px">–í–µ—Ç–∫–∞ (–∫—É–¥–∞ –ø–∏—Å–∞—Ç—å tasks.json):</label>
            <input type="text" id="repoBranch" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä: gh-pages (–µ—Å–ª–∏ –ø—É—Å—Ç–æ ‚Äî –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)" />
            <div style="margin-top: 20px; display: flex; gap: 10px">
              <button id="saveSettingsBtn" style="flex: 1">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
              <button id="cancelSettingsBtn" style="flex: 1; background: #a0aec0">–û—Ç–º–µ–Ω–∞</button>
            </div>
          </div>
          <p style="margin-top: 15px; font-size: 12px; color: #999; line-height: 1.5">
            –î–ª—è <strong>fine-grained</strong> —Ç–æ–∫–µ–Ω–∞ –≤–∫–ª—é—á–∏—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –Ω—É–∂–Ω–æ–º—É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—é –∏ –ø—Ä–∞–≤–∞ <strong>Contents: Read and write</strong>. –î–ª—è <strong>classic</strong> ‚Äî scope <strong>repo</strong>.
          </p>
        </div>
      </div>

      <div class="payment-block">
        <div class="payment-header">
          <div class="payment-title">üí∞ –†–∞—Å—á–µ—Ç –æ–ø–ª–∞—Ç—ã</div>
          <div class="usdt-rate" id="usdtRate">–ó–∞–≥—Ä—É–∑–∫–∞ –∫—É—Ä—Å–∞ USDT...</div>
        </div>

        <div class="payment-rate">
          <label style="font-weight: 600; color: #333">–°—Ç–∞–≤–∫–∞ –∑–∞ —á–∞—Å:</label>
          <input type="number" id="ratePerHour" value="1000" min="0" step="100" style="padding: 8px; border: 2px solid #e0e0e0; border-radius: 8px; width: 120px; font-size: 16px" />
          <span style="color: #666">‚ÇΩ/—á–∞—Å</span>
          <button id="saveRateBtn" style="padding: 8px 15px; font-size: 14px">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        </div>

        <div class="payment-stats">
          <div class="payment-stat-card">
            <div class="payment-stat-label">–í—Å–µ–≥–æ –∑–∞ –º–µ—Å—è—Ü</div>
            <div class="payment-stat-value" id="totalAmount">0 USDT</div>
          </div>
          <div class="payment-stat-card payment-stat-paid">
            <div class="payment-stat-label">–û–ø–ª–∞—á–µ–Ω–æ</div>
            <div class="payment-stat-value" id="paidAmount">0 USDT</div>
          </div>
          <div class="payment-stat-card payment-stat-unpaid">
            <div class="payment-stat-label">–ù–µ –æ–ø–ª–∞—á–µ–Ω–æ</div>
            <div class="payment-stat-value" id="unpaidAmount">0 USDT</div>
          </div>
        </div>

        <div class="monthly-stats" style="margin-top: 20px; padding-top: 20px; border-top: 2px solid #f0f0f0">
          <div class="additional-payments-header" style="margin-bottom: 15px">
            <div class="additional-payments-title">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –º–µ—Å—è—Ü–∞–º</div>
          </div>
          <div id="monthlyStatsList"></div>
        </div>

        <div class="additional-payments">
          <div class="additional-payments-header">
            <div class="additional-payments-title">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏</div>
            <div style="display: flex; gap: 8px; align-items: center">
              <div style="display: flex; gap: 8px">
                <button id="filterAdditionalAll" class="btn-add-subtimer filter-btn active" onclick="setAdditionalPaymentFilter('all')" style="padding: 6px 12px; font-size: 12px">–í—Å–µ</button>
                <button id="filterAdditionalPaid" class="btn-add-subtimer filter-btn" onclick="setAdditionalPaymentFilter('paid')" style="padding: 6px 12px; font-size: 12px">–û–ø–ª–∞—á–µ–Ω–æ</button>
                <button id="filterAdditionalUnpaid" class="btn-add-subtimer filter-btn" onclick="setAdditionalPaymentFilter('unpaid')" style="padding: 6px 12px; font-size: 12px">–ù–µ –æ–ø–ª–∞—á–µ–Ω–æ</button>
              </div>
              <button class="btn-add-subtimer" onclick="showAddPaymentModal()">+ –î–æ–±–∞–≤–∏—Ç—å –ø–ª–∞—Ç–µ–∂</button>
            </div>
          </div>
          <div class="additional-payments-list" id="additionalPaymentsList"></div>
        </div>

        <div class="additional-payments" style="margin-top: 20px">
          <div class="additional-payments-header">
            <div class="additional-payments-title">–ü–ª–∞—Ç–µ–∂–∏ –ø–æ —Ç–∞–π–º–µ—Ä–∞–º</div>
            <div style="display: flex; gap: 8px">
              <button id="filterTimerAll" class="btn-add-subtimer filter-btn active" onclick="setTimerPaymentFilter('all')" style="padding: 6px 12px; font-size: 12px">–í—Å–µ</button>
              <button id="filterTimerPaid" class="btn-add-subtimer filter-btn" onclick="setTimerPaymentFilter('paid')" style="padding: 6px 12px; font-size: 12px">–û–ø–ª–∞—á–µ–Ω–æ</button>
              <button id="filterTimerUnpaid" class="btn-add-subtimer filter-btn" onclick="setTimerPaymentFilter('unpaid')" style="padding: 6px 12px; font-size: 12px">–ù–µ –æ–ø–ª–∞—á–µ–Ω–æ</button>
            </div>
          </div>
          <div class="additional-payments-list" id="timerPaymentsList"></div>
        </div>
      </div>

      <div id="addPaymentModal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.5); z-index: 1000; align-items: center; justify-content: center">
        <div style="background: white; padding: 30px; border-radius: 15px; max-width: 400px; width: 90%; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3)">
          <h2 style="margin-bottom: 20px; color: #333">–î–æ–±–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–ª–∞—Ç–µ–∂</h2>
          <div style="display: flex; flex-direction: column; gap: 15px">
            <div>
              <label style="display: block; margin-bottom: 5px; color: #666; font-size: 14px">–û–ø–∏—Å–∞–Ω–∏–µ:</label>
              <input type="text" id="paymentNameInput" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ë–æ–Ω—É—Å –∑–∞ –ø—Ä–æ–µ–∫—Ç" style="width: 100%; padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 14px" />
            </div>
            <div>
              <label style="display: block; margin-bottom: 5px; color: #666; font-size: 14px">–°—É–º–º–∞ (USDT):</label>
              <input type="number" id="paymentAmountInput" placeholder="10.5" min="0" step="0.0001" style="width: 100%; padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 14px" />
            </div>
            <div style="display: flex; gap: 10px; margin-top: 10px">
              <button id="savePaymentBtn" style="flex: 1">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
              <button id="cancelPaymentBtn" style="flex: 1; background: #a0aec0">–û—Ç–º–µ–Ω–∞</button>
            </div>
          </div>
        </div>
      </div>

      <div class="add-task-form">
        <div class="form-group">
          <input type="text" id="taskInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏..." autocomplete="off" />
          <button id="addTaskBtn">–î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É</button>
        </div>
      </div>

      <div class="tasks-list" id="tasksList">
        <div class="empty-state">–ü–æ–∫–∞ –Ω–µ—Ç –∑–∞–¥–∞—á. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—É—é –∑–∞–¥–∞—á—É!</div>
      </div>

      <div class="archive-block">
        <div class="archive-header">
          <div class="archive-title">üì¶ –ê—Ä—Ö–∏–≤ –∑–∞–¥–∞—á</div>
          <button id="toggleArchiveBtn" class="archive-toggle-btn" onclick="toggleArchive()">–ü–æ–∫–∞–∑–∞—Ç—å –∞—Ä—Ö–∏–≤</button>
        </div>
        <div id="archiveContent" style="display: none">
          <div class="archive-list" id="archiveList">
            <div style="text-align: center; color: #999; padding: 20px">–ê—Ä—Ö–∏–≤ –ø—É—Å—Ç</div>
          </div>
        </div>
      </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –≤–≤–æ–¥–∞ —Ç–µ–∫—Å—Ç–∞ -->
    <div id="inputModal" class="modal-overlay" style="display: none">
      <div class="modal-content">
        <h2 class="modal-title" id="inputModalTitle">–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ</h2>
        <input type="text" id="inputModalInput" class="modal-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ..." />
        <div class="modal-buttons">
          <button id="inputModalCancel" class="modal-button modal-button-secondary">–û—Ç–º–µ–Ω–∞</button>
          <button id="inputModalOk" class="modal-button modal-button-primary">OK</button>
        </div>
      </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ -->
    <div id="timeEditModal" class="modal-overlay" style="display: none">
      <div class="modal-content">
        <h2 class="modal-title" id="timeEditModalTitle">–ò–∑–º–µ–Ω–∏—Ç—å –≤—Ä–µ–º—è</h2>
        <div style="margin-bottom: 10px; color: #666; font-size: 14px" id="timeEditModalCurrent"></div>
        <input type="text" id="timeEditModalInput" class="modal-input" placeholder="–ß–ß:–ú–ú:–°–° –∏–ª–∏ —Å–µ–∫—É–Ω–¥—ã" />
        <div style="font-size: 12px; color: #999; margin-bottom: 15px">–§–æ—Ä–º–∞—Ç: –ß–ß:–ú–ú:–°–° (–Ω–∞–ø—Ä–∏–º–µ—Ä: 01:30:45) –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ —Å–µ–∫—É–Ω–¥—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä: 5445)</div>
        <div class="modal-buttons">
          <button id="timeEditModalCancel" class="modal-button modal-button-secondary">–û—Ç–º–µ–Ω–∞</button>
          <button id="timeEditModalOk" class="modal-button modal-button-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        </div>
      </div>
    </div>

    <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π -->
    <div id="toastContainer"></div>

    <script>
      // –•—Ä–∞–Ω–∏–ª–∏—â–µ –∑–∞–¥–∞—á
      let tasks = [];
      let archivedTasks = []; // –ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏
      let timers = {}; // –û–±—ä–µ–∫—Ç –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ —Ç–∞–π–º–µ—Ä–æ–≤
      let githubConfig = null; // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è GitHub API
      let fileSha = null; // SHA —Ç–µ–∫—É—â–µ–≥–æ —Ñ–∞–π–ª–∞ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
      let saveTimeout = null; // –¢–∞–π–º–µ—Ä –¥–ª—è –æ—Ç–ª–æ–∂–µ–Ω–Ω–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
      let usdtRate = 100; // –ö—É—Ä—Å USDT/RUB (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 100, –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è)
      let ratePerHour = 1000; // –°—Ç–∞–≤–∫–∞ –∑–∞ —á–∞—Å –≤ —Ä—É–±–ª—è—Ö
      let additionalPayments = []; // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏
      let timerPaymentFilter = 'all'; // –§–∏–ª—å—Ç—Ä –¥–ª—è –ø–ª–∞—Ç–µ–∂–µ–π –ø–æ —Ç–∞–π–º–µ—Ä–∞–º: 'all', 'paid', 'unpaid'
      let additionalPaymentFilter = 'all'; // –§–∏–ª—å—Ç—Ä –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π: 'all', 'paid', 'unpaid'
      let archiveVisible = false; // –°–æ—Å—Ç–æ—è–Ω–∏–µ –≤–∏–¥–∏–º–æ—Å—Ç–∏ –∞—Ä—Ö–∏–≤–∞

      // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ owner –∏ repo –∏–∑ URL
      function detectGitHubInfo() {
        const hostname = window.location.hostname;
        const pathname = window.location.pathname;

        // –î–ª—è GitHub Pages: username.github.io –∏–ª–∏ username.github.io/repo-name
        if (hostname.includes('github.io')) {
          const parts = hostname.split('.');
          if (parts.length >= 3) {
            const owner = parts[0];
            // –ï—Å–ª–∏ pathname –Ω–µ –ø—É—Å—Ç–æ–π –∏ –Ω–µ –ø—Ä–æ—Å—Ç–æ "/", –∑–Ω–∞—á–∏—Ç –µ—Å—Ç—å –ø–æ–¥–ø–∞–ø–∫–∞ —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º —Ä–µ–ø–æ
            let repo = pathname.split('/').filter((p) => p)[0];
            // –ï—Å–ª–∏ –Ω–µ—Ç –ø–æ–¥–ø–∞–ø–∫–∏, —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –æ–±—ã—á–Ω–æ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è username.github.io
            if (!repo) {
              repo = `${owner}.github.io`;
            }
            return { owner, repo };
          }
        }
        return null;
      }

      // –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∏–∑ localStorage
      function loadSettings() {
        const saved = localStorage.getItem('githubConfig');
        if (saved) {
          githubConfig = JSON.parse(saved);
          updateFileStatus();
        } else {
          // –ü—Ä–æ–±—É–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∏–∑ URL
          const detected = detectGitHubInfo();
          if (detected) {
            githubConfig = { ...detected, token: '' };
          }
        }
      }

      // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –≤ localStorage
      function saveSettings() {
        if (githubConfig) {
          localStorage.setItem('githubConfig', JSON.stringify(githubConfig));
        }
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Ç–∞–≤–∫—É –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏
        localStorage.setItem('ratePerHour', ratePerHour.toString());
        localStorage.setItem('additionalPayments', JSON.stringify(additionalPayments));
        localStorage.setItem('archivedTasks', JSON.stringify(archivedTasks));
      }

      // –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –æ–ø–ª–∞—Ç—ã –∏–∑ localStorage
      function loadPaymentSettings() {
        const savedRate = localStorage.getItem('ratePerHour');
        if (savedRate) {
          ratePerHour = parseInt(savedRate);
          document.getElementById('ratePerHour').value = ratePerHour;
        }
        const savedPayments = localStorage.getItem('additionalPayments');
        if (savedPayments) {
          additionalPayments = JSON.parse(savedPayments);
        }
        const savedArchived = localStorage.getItem('archivedTasks');
        if (savedArchived) {
          archivedTasks = JSON.parse(savedArchived);
        }
      }

      // –ü–æ–ª—É—á–µ–Ω–∏–µ –∫—É—Ä—Å–∞ USDT/RUB
      async function fetchUSDTRate() {
        try {
          // –ò—Å–ø–æ–ª—å–∑—É–µ–º API CoinGecko –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫—É—Ä—Å–∞ USDT –≤ —Ä—É–±–ª—è—Ö
          const response = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=tether&vs_currencies=rub');
          if (response.ok) {
            const data = await response.json();
            if (data.tether && data.tether.rub) {
              usdtRate = data.tether.rub;
              document.getElementById('usdtRate').innerHTML = `–ö—É—Ä—Å USDT: <span class="usdt-rate-value">${usdtRate.toFixed(2)} ‚ÇΩ</span>`;
              updatePaymentStats();
              return true;
            }
          }
        } catch (error) {
          console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∫—É—Ä—Å–∞ USDT:', error);
        }
        // Fallback –Ω–∞ –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω—ã–π –∫—É—Ä—Å
        usdtRate = 100;
        document.getElementById('usdtRate').innerHTML = `–ö—É—Ä—Å USDT: <span class="usdt-rate-value">~${usdtRate.toFixed(2)} ‚ÇΩ</span> (–ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ)`;
        updatePaymentStats();
        return false;
      }

      // –†–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∑–∞–¥–∞—á–∏ –≤ USDT (–≤–∫–ª—é—á–∞—è –ø–æ–¥—Ç–∞–π–º–µ—Ä—ã)
      function calculateTaskCost(task) {
        // –°—á–∏—Ç–∞–µ–º –æ–±—â–µ–µ –≤—Ä–µ–º—è: –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–∞–π–º–µ—Ä + –≤—Å–µ –ø–æ–¥—Ç–∞–π–º–µ—Ä—ã
        let totalTime = task.time || 0;

        if (task.subtimers && task.subtimers.length > 0) {
          task.subtimers.forEach((subtimer) => {
            totalTime += subtimer.time || 0;
          });
        }

        const hours = totalTime / 3600; // –í—Ä–µ–º—è –≤ —á–∞—Å–∞—Ö
        const costInRub = hours * ratePerHour;
        const costInUsdt = costInRub / usdtRate;
        return costInUsdt;
      }

      // –ü–æ–ª—É—á–∏—Ç—å –æ–±—â–µ–µ –≤—Ä–µ–º—è –∑–∞–¥–∞—á–∏ (–≤–∫–ª—é—á–∞—è –ø–æ–¥—Ç–∞–π–º–µ—Ä—ã)
      function getTotalTaskTime(task) {
        let totalTime = task.time || 0;
        
        // –î–æ–±–∞–≤–ª—è–µ–º –≤—Ä–µ–º—è —Å —Ç–µ–∫—É—â–µ–≥–æ –∑–∞–ø—É—Å–∫–∞ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ç–∞–π–º–µ—Ä–∞, –µ—Å–ª–∏ –æ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç
        if (task.isRunning && task.startTime) {
          const elapsed = Math.floor((Date.now() - task.startTime) / 1000);
          totalTime += elapsed;
        }

        if (task.subtimers && task.subtimers.length > 0) {
          task.subtimers.forEach((subtimer) => {
            let subtimerTime = subtimer.time || 0;
            
            // –î–æ–±–∞–≤–ª—è–µ–º –≤—Ä–µ–º—è —Å —Ç–µ–∫—É—â–µ–≥–æ –∑–∞–ø—É—Å–∫–∞ –ø–æ–¥—Ç–∞–π–º–µ—Ä–∞, –µ—Å–ª–∏ –æ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç
            if (subtimer.isRunning && subtimer.startTime) {
              const elapsed = Math.floor((Date.now() - subtimer.startTime) / 1000);
              subtimerTime += elapsed;
            }
            
            totalTime += subtimerTime;
          });
        }

        return totalTime;
      }

      // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ –º–µ—Å—è—Ü–∞–º
      function renderMonthlyStats() {
        const list = document.getElementById('monthlyStatsList');

        // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏ –ø–æ –º–µ—Å—è—Ü–∞–º
        const monthlyStats = {};

        // –ü–ª–∞—Ç–µ–∂–∏ –ø–æ —Ç–∞–π–º–µ—Ä–∞–º
        tasks.forEach((task) => {
          if (task.paymentStatus === 'paid' && task.datePaid) {
            const date = new Date(task.datePaid);
            const monthKey = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}`;
            const monthName = date.toLocaleDateString('ru-RU', { year: 'numeric', month: 'long' });

            if (!monthlyStats[monthKey]) {
              monthlyStats[monthKey] = {
                key: monthKey,
                name: monthName,
                amount: 0,
              };
            }

            const taskCost = calculateTaskCost(task);
            monthlyStats[monthKey].amount += taskCost;
          }
        });

        // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏
        additionalPayments.forEach((payment) => {
          if (payment.status === 'paid') {
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º datePaid –µ—Å–ª–∏ –µ—Å—Ç—å, –∏–Ω–∞—á–µ date —Å–æ–∑–¥–∞–Ω–∏—è
            const datePaidStr = payment.datePaid || payment.date;
            if (!datePaidStr) return;

            const date = new Date(datePaidStr);
            const monthKey = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}`;
            const monthName = date.toLocaleDateString('ru-RU', { year: 'numeric', month: 'long' });

            if (!monthlyStats[monthKey]) {
              monthlyStats[monthKey] = {
                key: monthKey,
                name: monthName,
                amount: 0,
              };
            }

            monthlyStats[monthKey].amount += payment.amount;
          }
        });

        // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –¥–∞—Ç–µ (–Ω–æ–≤—ã–µ —Å–Ω–∞—á–∞–ª–∞)
        const sortedMonths = Object.values(monthlyStats).sort((a, b) => b.key.localeCompare(a.key));

        if (sortedMonths.length === 0) {
          list.innerHTML = '<div style="text-align: center; color: #999; padding: 20px">–ù–µ—Ç –æ–ø–ª–∞—á–µ–Ω–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π</div>';
          return;
        }

        list.innerHTML = sortedMonths
          .map(
            (month) => `
          <div class="additional-payment-item">
            <div class="additional-payment-info">
              <div class="additional-payment-name" style="font-weight: 600">${escapeHtml(month.name)}</div>
            </div>
            <div class="additional-payment-amount" style="font-size: 24px; font-weight: 700; color: #48bb78">
              ${month.amount.toFixed(1)} USDT
            </div>
          </div>
        `,
          )
          .join('');
      }

      // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –æ–ø–ª–∞—Ç—ã
      function updatePaymentStats() {
        let totalPayments = 0;
        let paidPayments = 0;
        let unpaidPayments = 0;

        // –°—á–∏—Ç–∞–µ–º –ø–ª–∞—Ç–µ–∂–∏ –ø–æ —Ç–∞–π–º–µ—Ä–∞–º (—Å—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–¥–∞—á –≤–∫–ª—é—á–∞—è –ø–æ–¥—Ç–∞–π–º–µ—Ä—ã)
        tasks.forEach((task) => {
          const taskCost = calculateTaskCost(task);
          if (taskCost > 0) {
            totalPayments += taskCost;
            const paymentStatus = task.paymentStatus || 'unpaid';
            if (paymentStatus === 'paid') {
              paidPayments += taskCost;
            } else {
              unpaidPayments += taskCost;
            }
          }
        });

        // –î–æ–±–∞–≤–ª—è–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏ (—É–∂–µ –≤ USDT)
        additionalPayments.forEach((payment) => {
          totalPayments += payment.amount;
          if (payment.status === 'paid') {
            paidPayments += payment.amount;
          } else {
            unpaidPayments += payment.amount;
          }
        });

        document.getElementById('totalAmount').textContent = totalPayments.toFixed(1) + ' USDT';
        document.getElementById('paidAmount').textContent = paidPayments.toFixed(1) + ' USDT';
        document.getElementById('unpaidAmount').textContent = unpaidPayments.toFixed(1) + ' USDT';

        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –º–µ—Å—è—Ü–∞–º
        renderMonthlyStats();
      }

      // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä –¥–ª—è –ø–ª–∞—Ç–µ–∂–µ–π –ø–æ —Ç–∞–π–º–µ—Ä–∞–º
      function setTimerPaymentFilter(filter) {
        timerPaymentFilter = filter;

        // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏
        document.getElementById('filterTimerAll').classList.toggle('active', filter === 'all');
        document.getElementById('filterTimerPaid').classList.toggle('active', filter === 'paid');
        document.getElementById('filterTimerUnpaid').classList.toggle('active', filter === 'unpaid');

        renderTimerPayments();
      }

      // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π
      function setAdditionalPaymentFilter(filter) {
        additionalPaymentFilter = filter;

        // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏
        document.getElementById('filterAdditionalAll').classList.toggle('active', filter === 'all');
        document.getElementById('filterAdditionalPaid').classList.toggle('active', filter === 'paid');
        document.getElementById('filterAdditionalUnpaid').classList.toggle('active', filter === 'unpaid');

        renderAdditionalPayments();
      }

      // –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Å—Ç–∞—Ç—É—Å –æ–ø–ª–∞—Ç—ã –ø–ª–∞—Ç–µ–∂–∞ –ø–æ —Ç–∞–π–º–µ—Ä—É
      async function toggleTimerPaymentStatus(taskId) {
        const task = tasks.find((t) => t.id === taskId);
        if (!task) return;

        if (!task.paymentStatus) {
          task.paymentStatus = 'unpaid';
        }

        const wasUnpaid = task.paymentStatus === 'unpaid';
        task.paymentStatus = task.paymentStatus === 'paid' ? 'unpaid' : 'paid';

        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞—Ç—É –æ–ø–ª–∞—Ç—ã, –µ—Å–ª–∏ –º–µ–Ω—è–µ–º —Å—Ç–∞—Ç—É—Å –Ω–∞ "–æ–ø–ª–∞—á–µ–Ω–æ"
        if (task.paymentStatus === 'paid' && wasUnpaid) {
          task.datePaid = new Date().toISOString();
        } else if (task.paymentStatus === 'unpaid') {
          // –£–¥–∞–ª—è–µ–º –¥–∞—Ç—É –æ–ø–ª–∞—Ç—ã, –µ—Å–ª–∏ –º–µ–Ω—è–µ–º —Å—Ç–∞—Ç—É—Å –Ω–∞ "–Ω–µ –æ–ø–ª–∞—á–µ–Ω–æ"
          delete task.datePaid;
        }

        await autoSaveTasks();
        renderTimerPayments();
        updatePaymentStats();
        renderMonthlyStats();
      }

      // –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –∑–∞–¥–∞—á—É –≤ –∞—Ä—Ö–∏–≤
      async function archiveTask(taskId) {
        const task = tasks.find((t) => t.id === taskId);
        if (!task) return;

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∑–∞–¥–∞—á–∞ –æ–ø–ª–∞—á–µ–Ω–∞
        if (task.paymentStatus !== 'paid') {
          showToast('–ú–æ–∂–Ω–æ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏', 'error');
          return;
        }

        const confirmed = await showConfirmModal('–ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å —ç—Ç—É –∑–∞–¥–∞—á—É –≤ –∞—Ä—Ö–∏–≤?');
        if (!confirmed) return;

        // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Å–µ —Ç–∞–π–º–µ—Ä—ã –∑–∞–¥–∞—á–∏
        if (timers[taskId]) {
          clearInterval(timers[taskId]);
          delete timers[taskId];
        }
        if (task.subtimers) {
          task.subtimers.forEach((subtimer) => {
            const timerKey = `${taskId}_${subtimer.id}`;
            if (timers[timerKey]) {
              clearInterval(timers[timerKey]);
              delete timers[timerKey];
            }
          });
        }

        // –î–æ–±–∞–≤–ª—è–µ–º –º–µ—Ç–∫—É –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏—è
        task.archivedAt = new Date().toISOString();

        // –ü–µ—Ä–µ–º–µ—â–∞–µ–º –≤ –∞—Ä—Ö–∏–≤
        archivedTasks.push(task);
        tasks = tasks.filter((t) => t.id !== taskId);

        saveSettings();
        await autoSaveTasks();
        renderTasks();
        renderTimerPayments();
        renderArchive();
        updatePaymentStats();
        showToast('–ó–∞–¥–∞—á–∞ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∞ –≤ –∞—Ä—Ö–∏–≤', 'success');
      }

      // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–¥–∞—á—É –∏–∑ –∞—Ä—Ö–∏–≤–∞
      async function unarchiveTask(taskId) {
        const taskIndex = archivedTasks.findIndex((t) => t.id === taskId);
        if (taskIndex === -1) return;

        const confirmed = await showConfirmModal('–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —ç—Ç—É –∑–∞–¥–∞—á—É –∏–∑ –∞—Ä—Ö–∏–≤–∞?');
        if (!confirmed) return;

        const task = archivedTasks[taskIndex];

        // –£–¥–∞–ª—è–µ–º –º–µ—Ç–∫—É –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏—è
        delete task.archivedAt;

        // –ü–µ—Ä–µ–º–µ—â–∞–µ–º –æ–±—Ä–∞—Ç–Ω–æ –≤ –∞–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏
        tasks.push(task);
        archivedTasks.splice(taskIndex, 1);

        saveSettings();
        await autoSaveTasks();
        renderTasks();
        renderTimerPayments();
        renderArchive();
        updatePaymentStats();
        showToast('–ó–∞–¥–∞—á–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∏–∑ –∞—Ä—Ö–∏–≤–∞', 'success');
      }

      // –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç—å –∞—Ä—Ö–∏–≤–∞
      function toggleArchive() {
        archiveVisible = !archiveVisible;
        const archiveContent = document.getElementById('archiveContent');
        const toggleBtn = document.getElementById('toggleArchiveBtn');

        if (archiveVisible) {
          archiveContent.style.display = 'block';
          toggleBtn.textContent = '–°–∫—Ä—ã—Ç—å –∞—Ä—Ö–∏–≤';
          renderArchive();
        } else {
          archiveContent.style.display = 'none';
          toggleBtn.textContent = '–ü–æ–∫–∞–∑–∞—Ç—å –∞—Ä—Ö–∏–≤';
        }
      }

      // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –∞—Ä—Ö–∏–≤–∞
      function renderArchive() {
        const archiveList = document.getElementById('archiveList');

        if (archivedTasks.length === 0) {
          archiveList.innerHTML = '<div style="text-align: center; color: #999; padding: 20px">–ê—Ä—Ö–∏–≤ –ø—É—Å—Ç</div>';
          return;
        }

        archiveList.innerHTML = archivedTasks
          .map((task) => {
            const totalTime = getTotalTaskTime(task);
            const taskCost = calculateTaskCost(task);
            const archivedDate = task.archivedAt
              ? new Date(task.archivedAt).toLocaleDateString('ru-RU', {
                  year: 'numeric',
                  month: 'long',
                  day: 'numeric',
                })
              : '–ù–µ —É–∫–∞–∑–∞–Ω–∞';

            const subtimersHtml =
              task.subtimers && task.subtimers.length > 0
                ? `
              <div style="margin-top: 10px; padding-top: 10px; border-top: 1px solid #e0e0e0">
                <div style="font-size: 14px; font-weight: 600; color: #666; margin-bottom: 8px">–ü–æ–¥—Ç–∞–π–º–µ—Ä—ã:</div>
                ${task.subtimers
                  .map(
                    (subtimer) => `
                  <div style="font-size: 13px; color: #666; margin-top: 5px; padding-left: 10px; border-left: 2px solid #764ba2">
                    <strong>${escapeHtml(subtimer.name)}:</strong> ${formatTime(subtimer.time)}
                  </div>
                `,
                  )
                  .join('')}
              </div>
            `
                : '';

            return `
              <div class="task-item" style="background: #f8f9fa">
                <div class="task-header">
                  <div class="task-main-info">
                    <div class="task-name" style="display: flex; align-items: center; gap: 10px">
                      ${escapeHtml(task.name)}
                      <span class="task-paid-badge paid">‚úì –û–ø–ª–∞—á–µ–Ω–æ</span>
                    </div>
                    <div style="font-size: 12px; color: #999; margin-top: 5px">
                      –ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–æ: ${archivedDate}
                    </div>
                    <div style="display: flex; gap: 20px; align-items: center; margin-top: 8px">
                      <div class="task-time" style="font-size: 20px">${formatTime(totalTime)}</div>
                      <div style="font-size: 16px; color: #48bb78; font-weight: 600">${taskCost.toFixed(1)} USDT</div>
                    </div>
                  </div>
                  <div class="task-actions">
                    <button class="btn-unarchive" onclick="unarchiveTask(${task.id})">
                      ‚Ü©Ô∏è –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
                    </button>
                  </div>
                </div>
                ${subtimersHtml}
              </div>
            `;
          })
          .join('');
      }

      // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π –ø–æ —Ç–∞–π–º–µ—Ä–∞–º
      function renderTimerPayments() {
        const list = document.getElementById('timerPaymentsList');

        const timerPayments = tasks
          .map((task) => ({
            id: task.id,
            name: task.name,
            amount: calculateTaskCost(task),
            time: getTotalTaskTime(task),
            status: task.paymentStatus || 'unpaid',
          }))
          .filter((payment) => {
            // –§–∏–ª—å—Ç—Ä—É–µ–º –ø–æ —Å—É–º–º–µ
            if (payment.amount <= 0) return false;
            // –§–∏–ª—å—Ç—Ä—É–µ–º –ø–æ —Å—Ç–∞—Ç—É—Å—É –æ–ø–ª–∞—Ç—ã
            if (timerPaymentFilter === 'paid' && payment.status !== 'paid') return false;
            if (timerPaymentFilter === 'unpaid' && payment.status !== 'unpaid') return false;
            return true;
          });

        if (timerPayments.length === 0) {
          const emptyMessage =
            tasks.filter((t) => calculateTaskCost(t) > 0).length === 0 ? '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ —Ç–∞–π–º–µ—Ä–∞–º' : timerPaymentFilter === 'paid' ? '–ù–µ—Ç –æ–ø–ª–∞—á–µ–Ω–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π' : timerPaymentFilter === 'unpaid' ? '–ù–µ—Ç –Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π' : '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ —Ç–∞–π–º–µ—Ä–∞–º';
          list.innerHTML = `<div style="text-align: center; color: #999; padding: 20px">${emptyMessage}</div>`;
          return;
        }

        list.innerHTML = timerPayments
          .map((payment) => {
            const isPaid = payment.status === 'paid';
            const task = tasks.find((t) => t.id === payment.id);

            // –§–æ—Ä–º–∏—Ä—É–µ–º –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—é –≤—Ä–µ–º–µ–Ω–∏
            let timeDetails = '';

            // –û—Å–Ω–æ–≤–Ω–æ–π —Ç–∞–π–º–µ—Ä
            if (task && task.time > 0) {
              timeDetails += `<div style="font-size: 13px; color: #666; margin-top: 5px; padding-left: 10px; border-left: 2px solid #667eea">
                <strong>–û—Å–Ω–æ–≤–Ω–æ–π —Ç–∞–π–º–µ—Ä:</strong> ${formatTime(task.time)}
              </div>`;
            }

            // –ü–æ–¥—Ç–∞–π–º–µ—Ä—ã
            if (task && task.subtimers && task.subtimers.length > 0) {
              task.subtimers.forEach((subtimer) => {
                if (subtimer.time > 0) {
                  timeDetails += `<div style="font-size: 13px; color: #666; margin-top: 5px; padding-left: 10px; border-left: 2px solid #764ba2">
                    <strong>${escapeHtml(subtimer.name)}:</strong> ${formatTime(subtimer.time)}
                  </div>`;
                }
              });
            }

            return `
          <div class="additional-payment-item" style="flex-direction: column; align-items: flex-start">
            <div style="display: flex; width: 100%; align-items: center; justify-content: space-between;">
              <div class="additional-payment-info" style="flex: 1">
                <div class="additional-payment-name">${escapeHtml(payment.name)}</div>
                <div class="additional-payment-date">–û–±—â–µ–µ –≤—Ä–µ–º—è: ${formatTime(payment.time)}</div>
              </div>
              <div class="additional-payment-amount" style="margin-right: 10px">${payment.amount.toFixed(1)} USDT</div>
              <div style="display: flex; gap: 8px">
                <button 
                  class="${isPaid ? 'btn-paid' : 'btn-unpaid'}" 
                  onclick="toggleTimerPaymentStatus(${payment.id})"
                >
                  ${isPaid ? '‚úì –û–ø–ª–∞—á–µ–Ω–æ' : '‚úó –ù–µ –æ–ø–ª–∞—á–µ–Ω–æ'}
                </button>
                ${
                  isPaid
                    ? `<button 
                    class="btn-archive" 
                    onclick="archiveTask(${payment.id})"
                    title="–ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤ –∞—Ä—Ö–∏–≤"
                  >
                    üì¶ –í –∞—Ä—Ö–∏–≤
                  </button>`
                    : ''
                }
              </div>
            </div>
            ${timeDetails ? `<div style="width: 100%; margin-top: 10px; padding-top: 10px; border-top: 1px solid #e0e0e0">${timeDetails}</div>` : ''}
          </div>
        `;
          })
          .join('');
      }

      // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–ª–∞—Ç–µ–∂–∞
      function showAddPaymentModal() {
        document.getElementById('addPaymentModal').style.display = 'flex';
        document.getElementById('paymentNameInput').value = '';
        document.getElementById('paymentAmountInput').value = '';
      }

      // –°–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–ª–∞—Ç–µ–∂–∞
      function hideAddPaymentModal() {
        document.getElementById('addPaymentModal').style.display = 'none';
      }

      // –î–æ–±–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–ª–∞—Ç–µ–∂ (–≤ USDT)
      async function addAdditionalPayment() {
        const name = document.getElementById('paymentNameInput').value.trim();
        const amount = parseFloat(document.getElementById('paymentAmountInput').value);

        if (!name || !amount || amount <= 0 || isNaN(amount)) {
          showToast('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ', 'error');
          return;
        }

        const payment = {
          id: Date.now(),
          name: name,
          amount: amount, // –£–∂–µ –≤ USDT
          date: new Date().toISOString(),
          status: 'unpaid',
        };

        additionalPayments.push(payment);
        saveSettings();
        hideAddPaymentModal();
        renderAdditionalPayments();
        updatePaymentStats();
      }

      // –û—Ç–º–µ—Ç–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–ª–∞—Ç–µ–∂ –∫–∞–∫ –æ–ø–ª–∞—á–µ–Ω–Ω—ã–π/–Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–π
      async function togglePaymentStatus(paymentId) {
        const payment = additionalPayments.find((p) => p.id === paymentId);
        if (!payment) return;

        const wasUnpaid = payment.status === 'unpaid';

        if (payment.status === 'paid') {
          payment.status = 'unpaid';
        } else {
          payment.status = 'paid';
          // –ï—Å–ª–∏ –º–µ–Ω—è–µ–º —Å—Ç–∞—Ç—É—Å –Ω–∞ "–æ–ø–ª–∞—á–µ–Ω–æ" –∏ –¥–∞—Ç—ã –æ–ø–ª–∞—Ç—ã –Ω–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–∞—Ç—É —Å–æ–∑–¥–∞–Ω–∏—è –∏–ª–∏ —Ç–µ–∫—É—â—É—é –¥–∞—Ç—É
          if (wasUnpaid && !payment.datePaid) {
            payment.datePaid = payment.date || new Date().toISOString();
          }
        }

        saveSettings();
        renderAdditionalPayments();
        updatePaymentStats();
        renderMonthlyStats();
      }

      // –£–¥–∞–ª–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–ª–∞—Ç–µ–∂
      async function deleteAdditionalPayment(paymentId) {
        const confirmed = await showConfirmModal('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –ø–ª–∞—Ç–µ–∂?');
        if (!confirmed) return;

        additionalPayments = additionalPayments.filter((p) => p.id !== paymentId);
        saveSettings();
        renderAdditionalPayments();
        updatePaymentStats();
      }

      // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π
      function renderAdditionalPayments() {
        const list = document.getElementById('additionalPaymentsList');

        // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ñ–∏–ª—å—Ç—Ä
        const filteredPayments = additionalPayments.filter((payment) => {
          if (additionalPaymentFilter === 'paid' && payment.status !== 'paid') return false;
          if (additionalPaymentFilter === 'unpaid' && payment.status !== 'unpaid') return false;
          return true;
        });

        if (filteredPayments.length === 0) {
          const emptyMessage =
            additionalPayments.length === 0 ? '–ù–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π' : additionalPaymentFilter === 'paid' ? '–ù–µ—Ç –æ–ø–ª–∞—á–µ–Ω–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π' : additionalPaymentFilter === 'unpaid' ? '–ù–µ—Ç –Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π' : '–ù–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π';
          list.innerHTML = `<div style="text-align: center; color: #999; padding: 20px">${emptyMessage}</div>`;
          return;
        }

        list.innerHTML = filteredPayments
          .map(
            (payment) => `
          <div class="additional-payment-item">
            <div class="additional-payment-info">
              <div class="additional-payment-name">${escapeHtml(payment.name)}</div>
              <div class="additional-payment-date">${new Date(payment.date).toLocaleDateString('ru-RU')}</div>
            </div>
            <div class="additional-payment-amount">${payment.amount.toFixed(1)} USDT</div>
            <div style="display: flex; gap: 8px">
              <button 
                class="${payment.status === 'paid' ? 'btn-paid' : 'btn-unpaid'}" 
                onclick="togglePaymentStatus(${payment.id})"
              >
                ${payment.status === 'paid' ? '‚úì –û–ø–ª–∞—á–µ–Ω–æ' : '‚úó –ù–µ –æ–ø–ª–∞—á–µ–Ω–æ'}
              </button>
              <button class="btn-delete" onclick="deleteAdditionalPayment(${payment.id})">
                üóë
              </button>
            </div>
          </div>
        `,
          )
          .join('');
      }

      // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ —Ñ–∞–π–ª–∞
      function updateFileStatus() {
        const statusEl = document.getElementById('fileStatus');
        const reloadBtn = document.getElementById('reloadBtn');
        if (githubConfig && githubConfig.token && githubConfig.owner && githubConfig.repo) {
          statusEl.textContent = '‚úÖ –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ';
          statusEl.style.color = '#48bb78';
          reloadBtn.style.display = 'block';
        } else {
          statusEl.textContent = '‚ö†Ô∏è –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ç–∫–ª—é—á–µ–Ω–æ';
          statusEl.style.color = '#f56565';
          reloadBtn.style.display = 'none';
        }
      }

      // –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
      function showSaveStatus(message, isError = false) {
        const statusEl = document.getElementById('saveStatus');
        statusEl.textContent = message;
        statusEl.style.color = isError ? '#f56565' : '#48bb78';
        statusEl.style.display = 'block';
        setTimeout(() => {
          statusEl.style.display = 'none';
        }, 3000);
      }

      function githubApiHeaders() {
        return {
          Authorization: `Bearer ${githubConfig.token}`,
          Accept: 'application/vnd.github+json',
          'X-GitHub-Api-Version': '2022-11-28',
        };
      }

      function githubContentsUrl(path) {
        const base = `https://api.github.com/repos/${githubConfig.owner}/${githubConfig.repo}/contents/${path}`;
        if (githubConfig.branch) {
          return `${base}?ref=${encodeURIComponent(githubConfig.branch)}`;
        }
        return base;
      }

      async function testGitHubAccess() {
        try {
          const repoResp = await fetch(`https://api.github.com/repos/${githubConfig.owner}/${githubConfig.repo}`, {
            headers: githubApiHeaders(),
          });

          if (!repoResp.ok) {
            const err = await repoResp.json().catch(() => ({}));
            const msg = err.message ? `: ${err.message}` : '';
            showSaveStatus(`‚úó –ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–µ–ø–æ (${repoResp.status}${msg})`, true);
            return false;
          }

          const shaResp = await fetch(githubContentsUrl('tasks.json'), { headers: githubApiHeaders() });
          if (shaResp.status === 403) {
            const err = await shaResp.json().catch(() => ({}));
            const msg = err.message ? `: ${err.message}` : '';
            showSaveStatus(`‚úó 403: –ø—Ä–æ–≤–µ—Ä—å –ø—Ä–∞–≤–∞ Contents${msg}`, true);
            return false;
          }
          return true;
        } catch (error) {
          console.error('–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–∞:', error);
          showSaveStatus('‚úó –û—à–∏–±–∫–∞ —Å–µ—Ç–∏/–¥–æ—Å—Ç—É–ø–∞ –∫ GitHub API', true);
          return false;
        }
      }

      // –ü–æ–ª—É—á–∏—Ç—å SHA —Ñ–∞–π–ª–∞ (–µ—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
      async function getFileSha() {
        if (!githubConfig) return null;
        try {
          const response = await fetch(githubContentsUrl('tasks.json'), { headers: githubApiHeaders() });
          if (response.ok) {
            const data = await response.json();
            return data.sha;
          }
          if (response.status === 403) {
            const err = await response.json().catch(() => ({}));
            const msg = err.message ? `: ${err.message}` : '';
            showSaveStatus(`‚úó 403: –Ω–µ—Ç –ø—Ä–∞–≤ –Ω–∞ —á—Ç–µ–Ω–∏–µ Contents${msg}`, true);
          }
        } catch (error) {
          console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è SHA:', error);
        }
        return null;
      }

      // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ GitHub API
      async function autoSaveTasks() {
        if (!githubConfig || !githubConfig.token || !githubConfig.owner || !githubConfig.repo) {
          return;
        }

        // –û—Ç–ª–æ–∂–µ–Ω–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ (—á—Ç–æ–±—ã –Ω–µ —Å–ø–∞–º–∏—Ç—å API)
        if (saveTimeout) {
          clearTimeout(saveTimeout);
        }

        saveTimeout = setTimeout(async () => {
          try {
            const data = JSON.stringify(tasks, null, 2);
            const content = btoa(unescape(encodeURIComponent(data))); // Base64 –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ

            // –ü–æ–ª—É—á–∞–µ–º SHA —Ç–µ–∫—É—â–µ–≥–æ —Ñ–∞–π–ª–∞
            if (!fileSha) {
              fileSha = await getFileSha();
            }

            const url = githubContentsUrl('tasks.json').split('?')[0];
            const body = {
              message: 'Auto-save tasks',
              content: content,
            };

            // –ï—Å–ª–∏ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –¥–æ–±–∞–≤–ª—è–µ–º SHA –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
            if (fileSha) {
              body.sha = fileSha;
            }

            if (githubConfig.branch) {
              body.branch = githubConfig.branch;
            }

            const response = await fetch(url, {
              method: 'PUT',
              headers: {
                ...githubApiHeaders(),
                'Content-Type': 'application/json',
              },
              body: JSON.stringify(body),
            });

            if (response.ok) {
              const result = await response.json();
              fileSha = result.content.sha;
              showSaveStatus('‚úì –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ');
            } else if (response.status === 409) {
              // –ö–æ–Ω—Ñ–ª–∏–∫—Ç SHA - –ø–æ–ª—É—á–∞–µ–º —Å–≤–µ–∂–∏–π SHA –∏ –ø–æ–≤—Ç–æ—Ä—è–µ–º –ø–æ–ø—ã—Ç–∫—É
              console.log('–ö–æ–Ω—Ñ–ª–∏–∫—Ç SHA, –ø–æ–ª—É—á–∞–µ–º –∞–∫—Ç—É–∞–ª—å–Ω—ã–π...');
              fileSha = await getFileSha();
              if (fileSha) {
                body.sha = fileSha;
                const retryResponse = await fetch(url, {
                  method: 'PUT',
                  headers: {
                    ...githubApiHeaders(),
                    'Content-Type': 'application/json',
                  },
                  body: JSON.stringify(body),
                });
                if (retryResponse.ok) {
                  const result = await retryResponse.json();
                  fileSha = result.content.sha;
                  showSaveStatus('‚úì –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ (–ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è)');
                } else {
                  const error = await retryResponse.json().catch(() => ({}));
                  const msg = error.message ? `: ${error.message}` : '';
                  showSaveStatus(`‚úó –û—à–∏–±–∫–∞ –ø–æ—Å–ª–µ –ø–æ–≤—Ç–æ—Ä–∞ (${retryResponse.status}${msg})`, true);
                }
              } else {
                showSaveStatus('‚úó –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—ã–π SHA', true);
              }
            } else {
              const error = await response.json().catch(() => ({}));
              const msg = error.message ? `: ${error.message}` : '';
              console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', response.status, error);
              if (response.status === 403) {
                showSaveStatus(`‚úó 403: –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞/–ø—Ä–∞–≤ –Ω–∞ –∑–∞–ø–∏—Å—å Contents${msg}`, true);
              } else if (response.status === 404) {
                showSaveStatus(`‚úó 404: —Ä–µ–ø–æ/–≤–µ—Ç–∫–∞/–ø—É—Ç—å –Ω–µ –Ω–∞–π–¥–µ–Ω${msg}`, true);
              } else {
                showSaveStatus(`‚úó –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è (${response.status}${msg})`, true);
              }
            }
          } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', error);
            showSaveStatus('‚úó –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è', true);
          }
        }, 1000); // –°–æ—Ö—Ä–∞–Ω—è–µ–º —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É –ø–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è
      }

      // –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–¥–∞—á –∏–∑ GitHub API
      async function loadTasksFromGitHub() {
        if (!githubConfig || !githubConfig.token) {
          return false;
        }
        try {
          const response = await fetch(githubContentsUrl('tasks.json'), {
            headers: githubApiHeaders(),
          });
          if (response.ok) {
            const data = await response.json();
            // –î–µ–∫–æ–¥–∏—Ä—É–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∏–∑ base64
            const content = decodeURIComponent(escape(atob(data.content)));
            tasks = JSON.parse(content);
            // –ú–∏–≥—Ä–∞—Ü–∏—è: –¥–æ–±–∞–≤–ª—è–µ–º –ø—É—Å—Ç—ã–µ –º–∞—Å—Å–∏–≤—ã –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –∑–∞–¥–∞—á
            tasks.forEach((task) => {
              if (!task.subtimers) {
                task.subtimers = [];
              }
              if (!task.paymentStatus) {
                task.paymentStatus = 'unpaid';
              }
              // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ –ø–æ–ª—è, –µ—Å–ª–∏ –µ—Å—Ç—å
              if (task.payments) {
                delete task.payments;
              }
              if (task.status) {
                delete task.status;
              }
            });
            fileSha = data.sha;
            renderTasks();
            restoreTimers();
            renderAdditionalPayments();
            renderTimerPayments();
            renderArchive();
            updatePaymentStats();
            renderMonthlyStats();
            console.log('–ó–∞–¥–∞—á–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ GitHub:', tasks.length);
            return true;
          }
        } catch (error) {
          console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑ GitHub:', error);
        }
        return false;
      }

      // –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–¥–∞—á –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
      async function loadTasksOnInit() {
        // –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–±—É–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ GitHub API (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)
        const loadedFromGitHub = await loadTasksFromGitHub();

        if (!loadedFromGitHub) {
          // Fallback: –ø—Ä–æ–±—É–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª
          try {
            const response = await fetch('./tasks.json');
            if (response.ok) {
              const data = await response.json();
              tasks = data;
              // –ú–∏–≥—Ä–∞—Ü–∏—è: –¥–æ–±–∞–≤–ª—è–µ–º –ø—É—Å—Ç—ã–µ –º–∞—Å—Å–∏–≤—ã –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –∑–∞–¥–∞—á
              tasks.forEach((task) => {
                if (!task.subtimers) {
                  task.subtimers = [];
                }
                if (!task.paymentStatus) {
                  task.paymentStatus = 'unpaid';
                }
                // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ –ø–æ–ª—è, –µ—Å–ª–∏ –µ—Å—Ç—å
                if (task.payments) {
                  delete task.payments;
                }
                if (task.status) {
                  delete task.status;
                }
              });
              renderTasks();
              restoreTimers();
              renderAdditionalPayments();
              renderTimerPayments();
              renderArchive();
              updatePaymentStats();
              renderMonthlyStats();
              // –ü–æ–ª—É—á–∞–µ–º SHA —Ñ–∞–π–ª–∞ –¥–ª—è –±—É–¥—É—â–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
              if (githubConfig) {
                fileSha = await getFileSha();
              }
            }
          } catch (error) {
            // –§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ –æ—à–∏–±–∫–∞ - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ
            console.log('–§–∞–π–ª tasks.json –Ω–µ –Ω–∞–π–¥–µ–Ω, –Ω–∞—á–∏–Ω–∞–µ–º —Å –ø—É—Å—Ç–æ–≥–æ —Å–ø–∏—Å–∫–∞');
          }
        }
      }

      // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–æ–¥–∞–ª—å–Ω—ã–º –æ–∫–Ω–æ–º –Ω–∞—Å—Ç—Ä–æ–µ–∫
      function showSettings() {
        document.getElementById('settingsModal').style.display = 'flex';
        if (githubConfig) {
          document.getElementById('githubToken').value = githubConfig.token || '';
          document.getElementById('repoOwner').value = githubConfig.owner || '';
          document.getElementById('repoName').value = githubConfig.repo || '';
          document.getElementById('repoBranch').value = githubConfig.branch || '';
        } else {
          // –ü—Ä–æ–±—É–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∏–∑ URL
          const detected = detectGitHubInfo();
          if (detected) {
            document.getElementById('repoOwner').value = detected.owner;
            document.getElementById('repoName').value = detected.repo;
          }
        }
      }

      function hideSettings() {
        document.getElementById('settingsModal').style.display = 'none';
      }

      async function saveSettingsAndClose() {
        const token = document.getElementById('githubToken').value.trim();
        const owner = document.getElementById('repoOwner').value.trim();
        const repo = document.getElementById('repoName').value.trim();
        const branch = document.getElementById('repoBranch').value.trim();

        if (!token || !owner || !repo) {
          showToast('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è', 'error');
          return;
        }

        githubConfig = { token, owner, repo, branch };
        saveSettings();
        updateFileStatus();
        const ok = await testGitHubAccess();
        if (!ok) return;

        fileSha = await getFileSha();
        hideSettings();

        // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
        await loadTasksOnInit();
        renderAdditionalPayments();
        renderTimerPayments();
        renderArchive();
        updatePaymentStats();
        renderMonthlyStats();
      }

      // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ (—Å–µ–∫—É–Ω–¥—ã –≤ –ß–ß:–ú–ú:–°–°)
      function formatTime(seconds) {
        const hours = Math.floor(seconds / 3600);
        const minutes = Math.floor((seconds % 3600) / 60);
        const secs = seconds % 60;
        return `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(secs).padStart(2, '0')}`;
      }

      // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π –∑–∞–¥–∞—á–∏
      async function addTask() {
        const input = document.getElementById('taskInput');
        const taskName = input.value.trim();

        if (!taskName) {
          showToast('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏', 'error');
          return;
        }

        const newTask = {
          id: Date.now(),
          name: taskName,
          time: 0,
          isRunning: false,
          subtimers: [],
          paymentStatus: 'unpaid',
        };

        tasks.push(newTask);
        input.value = '';
        await autoSaveTasks();
        renderTasks();
        renderTimerPayments();
        updatePaymentStats();
      }

      // –ó–∞–ø—É—Å–∫/–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–∞–π–º–µ—Ä–∞
      async function toggleTimer(taskId) {
        const task = tasks.find((t) => t.id === taskId);
        if (!task) return;

        if (task.isRunning) {
          // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–∞–π–º–µ—Ä–∞ - –≤—ã—á–∏—Å–ª—è–µ–º –ø—Ä–æ—à–µ–¥—à–µ–µ –≤—Ä–µ–º—è –∏ –¥–æ–±–∞–≤–ª—è–µ–º –∫ –æ–±—â–µ–º—É
          task.isRunning = false;
          if (task.startTime) {
            const elapsed = Math.floor((Date.now() - task.startTime) / 1000);
            task.time += elapsed;
            delete task.startTime; // –£–¥–∞–ª—è–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é –º–µ—Ç–∫—É
          }
          if (timers[taskId]) {
            clearInterval(timers[taskId]);
            delete timers[taskId];
          }
        } else {
          // –ó–∞–ø—É—Å–∫ —Ç–∞–π–º–µ—Ä–∞ - —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é –º–µ—Ç–∫—É —Å—Ç–∞—Ä—Ç–∞
          task.isRunning = true;
          task.startTime = Date.now(); // –ó–∞–ø–æ–º–∏–Ω–∞–µ–º –≤—Ä–µ–º—è —Å—Ç–∞—Ä—Ç–∞
          
          // setInterval –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è UI
          timers[taskId] = setInterval(() => {
            updateTaskTime(taskId);
          }, 1000);
        }

        await autoSaveTasks();
        renderTasks();
        renderTimerPayments();
        updatePaymentStats();
      }

      // –ü–æ–∫–∞–∑–∞—Ç—å toast-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
      function showToast(message, type = 'info') {
        const container = document.getElementById('toastContainer');
        const toast = document.createElement('div');
        toast.className = `toast ${type}`;

        const icons = {
          error: '‚ùå',
          success: '‚úÖ',
          info: '‚ÑπÔ∏è',
        };

        toast.innerHTML = `
          <span class="toast-icon">${icons[type] || icons.info}</span>
          <span class="toast-message">${escapeHtml(message)}</span>
        `;

        container.appendChild(toast);

        setTimeout(() => {
          toast.style.animation = 'toastSlideIn 0.3s ease-out reverse';
          setTimeout(() => {
            container.removeChild(toast);
          }, 300);
        }, 3000);
      }

      // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –≤–≤–æ–¥–∞ —Ç–µ–∫—Å—Ç–∞
      function showInputModal(title, placeholder = '', defaultValue = '') {
        return new Promise((resolve) => {
          const modal = document.getElementById('inputModal');
          const titleEl = document.getElementById('inputModalTitle');
          const inputEl = document.getElementById('inputModalInput');
          const okBtn = document.getElementById('inputModalOk');
          const cancelBtn = document.getElementById('inputModalCancel');

          titleEl.textContent = title;
          inputEl.placeholder = placeholder;
          inputEl.value = defaultValue;
          modal.style.display = 'flex';
          inputEl.focus();
          inputEl.select();

          const cleanup = () => {
            modal.style.display = 'none';
            inputEl.value = '';
            okBtn.onclick = null;
            cancelBtn.onclick = null;
            inputEl.onkeypress = null;
            modal.onclick = null;
          };

          okBtn.onclick = () => {
            const value = inputEl.value.trim();
            cleanup();
            resolve(value);
          };

          cancelBtn.onclick = () => {
            cleanup();
            resolve(null);
          };

          modal.onclick = (e) => {
            if (e.target === modal) {
              cleanup();
              resolve(null);
            }
          };

          inputEl.onkeypress = (e) => {
            if (e.key === 'Enter') {
              okBtn.click();
            } else if (e.key === 'Escape') {
              cancelBtn.click();
            }
          };
        });
      }

      // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏
      function showTimeEditModal(title, currentTime) {
        return new Promise((resolve) => {
          const modal = document.getElementById('timeEditModal');
          const titleEl = document.getElementById('timeEditModalTitle');
          const currentEl = document.getElementById('timeEditModalCurrent');
          const inputEl = document.getElementById('timeEditModalInput');
          const okBtn = document.getElementById('timeEditModalOk');
          const cancelBtn = document.getElementById('timeEditModalCancel');

          titleEl.textContent = title;
          currentEl.textContent = `–¢–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è: ${formatTime(currentTime)}`;
          inputEl.value = formatTime(currentTime);
          modal.style.display = 'flex';
          inputEl.focus();
          inputEl.select();

          let handleKeyPress, handleKeyDown, handleModalClick, handleOkClick, handleCancelClick;

          const cleanup = () => {
            modal.style.display = 'none';
            inputEl.value = '';
            if (handleKeyPress) inputEl.removeEventListener('keypress', handleKeyPress);
            if (handleKeyDown) inputEl.removeEventListener('keydown', handleKeyDown);
            if (handleModalClick) modal.removeEventListener('click', handleModalClick);
            if (handleOkClick) okBtn.removeEventListener('click', handleOkClick);
            if (handleCancelClick) cancelBtn.removeEventListener('click', handleCancelClick);
          };

          handleOkClick = () => {
            const value = inputEl.value.trim();
            cleanup();
            resolve(value);
          };

          handleCancelClick = () => {
            cleanup();
            resolve(null);
          };

          handleModalClick = (e) => {
            if (e.target === modal) {
              cleanup();
              resolve(null);
            }
          };

          handleKeyPress = (e) => {
            if (e.key === 'Enter') {
              okBtn.click();
            }
          };

          handleKeyDown = (e) => {
            if (e.key === 'Escape') {
              cancelBtn.click();
            }
          };

          okBtn.addEventListener('click', handleOkClick);
          cancelBtn.addEventListener('click', handleCancelClick);
          modal.addEventListener('click', handleModalClick);
          inputEl.addEventListener('keypress', handleKeyPress);
          inputEl.addEventListener('keydown', handleKeyDown);
        });
      }

      // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
      function showConfirmModal(message) {
        return new Promise((resolve) => {
          const modal = document.createElement('div');
          modal.className = 'modal-overlay';
          modal.innerHTML = `
            <div class="modal-content">
              <h2 class="modal-title">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ</h2>
              <p style="margin-bottom: 20px; color: #666; font-size: 16px; line-height: 1.5">${escapeHtml(message)}</p>
              <div class="modal-buttons">
                <button class="modal-button modal-button-secondary" id="confirmCancel">–û—Ç–º–µ–Ω–∞</button>
                <button class="modal-button modal-button-primary" id="confirmOk">–î–∞, –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
              </div>
            </div>
          `;
          document.body.appendChild(modal);

          const okBtn = modal.querySelector('#confirmOk');
          const cancelBtn = modal.querySelector('#confirmCancel');

          const cleanup = () => {
            document.body.removeChild(modal);
            okBtn.onclick = null;
            cancelBtn.onclick = null;
            modal.onclick = null;
          };

          okBtn.onclick = () => {
            cleanup();
            resolve(true);
          };

          cancelBtn.onclick = () => {
            cleanup();
            resolve(false);
          };

          modal.onclick = (e) => {
            if (e.target === modal) {
              cleanup();
              resolve(false);
            }
          };
        });
      }

      // –ü–∞—Ä—Å–∏–Ω–≥ –≤—Ä–µ–º–µ–Ω–∏ –∏–∑ —Å—Ç—Ä–æ–∫–∏ (—Ñ–æ—Ä–º–∞—Ç –ß–ß:–ú–ú:–°–° –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ —Å–µ–∫—É–Ω–¥—ã)
      function parseTimeInput(input) {
        const trimmed = input.trim();

        // –ï—Å–ª–∏ —Ñ–æ—Ä–º–∞—Ç –ß–ß:–ú–ú:–°–°
        const timeMatch = trimmed.match(/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/);
        if (timeMatch) {
          const hours = parseInt(timeMatch[1], 10);
          const minutes = parseInt(timeMatch[2], 10);
          const seconds = parseInt(timeMatch[3], 10);

          if (minutes >= 60 || seconds >= 60) {
            return null; // –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
          }

          return hours * 3600 + minutes * 60 + seconds;
        }

        // –ï—Å–ª–∏ –ø—Ä–æ—Å—Ç–æ —á–∏—Å–ª–æ (—Å–µ–∫—É–Ω–¥—ã)
        const secondsNum = parseInt(trimmed, 10);
        if (!isNaN(secondsNum) && secondsNum >= 0) {
          return secondsNum;
        }

        return null; // –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
      }

      // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ç–∞–π–º–µ—Ä–∞
      async function editTaskTime(taskId) {
        const task = tasks.find((t) => t.id === taskId);
        if (!task) return;

        // –í—ã—á–∏—Å–ª—è–µ–º —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è —Å —É—á–µ—Ç–æ–º —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ —Ç–∞–π–º–µ—Ä–∞
        let currentTime = task.time;
        if (task.isRunning && task.startTime) {
          const elapsed = Math.floor((Date.now() - task.startTime) / 1000);
          currentTime = task.time + elapsed;
        }

        const input = await showTimeEditModal(`–ò–∑–º–µ–Ω–∏—Ç—å –≤—Ä–µ–º—è –¥–ª—è "${task.name}"`, currentTime);

        if (input === null) return; // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–º–µ–Ω–∏–ª

        const newTime = parseTimeInput(input);
        if (newTime === null) {
          showToast('–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –≤—Ä–µ–º–µ–Ω–∏! –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–æ—Ä–º–∞—Ç –ß–ß:–ú–ú:–°–° (–Ω–∞–ø—Ä–∏–º–µ—Ä: 01:30:45) –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ —á–∏—Å–ª–æ —Å–µ–∫—É–Ω–¥ (–Ω–∞–ø—Ä–∏–º–µ—Ä: 5445)', 'error');
          return;
        }

        // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–∞–π–º–µ—Ä, –µ—Å–ª–∏ –æ–Ω –∑–∞–ø—É—â–µ–Ω
        if (task.isRunning && timers[taskId]) {
          clearInterval(timers[taskId]);
          delete timers[taskId];
          task.isRunning = false;
          delete task.startTime; // –£–¥–∞–ª—è–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é –º–µ—Ç–∫—É
        }

        task.time = newTime;
        await autoSaveTasks();
        renderTasks();
        renderTimerPayments();
        updatePaymentStats();
        showToast('–í—Ä–µ–º—è —É—Å–ø–µ—à–Ω–æ –∏–∑–º–µ–Ω–µ–Ω–æ', 'success');
      }

      // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ–¥—Ç–∞–π–º–µ—Ä–∞
      async function editSubtimerTime(taskId, subtimerId) {
        const task = tasks.find((t) => t.id === taskId);
        if (!task || !task.subtimers) return;

        const subtimer = task.subtimers.find((st) => st.id === subtimerId);
        if (!subtimer) return;

        // –í—ã—á–∏—Å–ª—è–µ–º —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è —Å —É—á–µ—Ç–æ–º —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ –ø–æ–¥—Ç–∞–π–º–µ—Ä–∞
        let currentTime = subtimer.time;
        if (subtimer.isRunning && subtimer.startTime) {
          const elapsed = Math.floor((Date.now() - subtimer.startTime) / 1000);
          currentTime = subtimer.time + elapsed;
        }

        const input = await showTimeEditModal(`–ò–∑–º–µ–Ω–∏—Ç—å –≤—Ä–µ–º—è –¥–ª—è "${subtimer.name}"`, currentTime);

        if (input === null) return; // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–º–µ–Ω–∏–ª

        const newTime = parseTimeInput(input);
        if (newTime === null) {
          showToast('–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –≤—Ä–µ–º–µ–Ω–∏! –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–æ—Ä–º–∞—Ç –ß–ß:–ú–ú:–°–° (–Ω–∞–ø—Ä–∏–º–µ—Ä: 00:30:15) –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ —á–∏—Å–ª–æ —Å–µ–∫—É–Ω–¥ (–Ω–∞–ø—Ä–∏–º–µ—Ä: 1815)', 'error');
          return;
        }

        // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–æ–¥—Ç–∞–π–º–µ—Ä, –µ—Å–ª–∏ –æ–Ω –∑–∞–ø—É—â–µ–Ω
        const timerKey = `${taskId}_${subtimerId}`;
        if (subtimer.isRunning && timers[timerKey]) {
          clearInterval(timers[timerKey]);
          delete timers[timerKey];
          subtimer.isRunning = false;
          delete subtimer.startTime; // –£–¥–∞–ª—è–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é –º–µ—Ç–∫—É
        }

        subtimer.time = newTime;
        await autoSaveTasks();
        renderTasks();
        renderTimerPayments();
        updatePaymentStats();
        showToast('–í—Ä–µ–º—è —É—Å–ø–µ—à–Ω–æ –∏–∑–º–µ–Ω–µ–Ω–æ', 'success');
      }

      // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–¥–∞—á–∏
      function updateTaskTime(taskId) {
        const task = tasks.find((t) => t.id === taskId);
        if (!task) return;

        // –í—ã—á–∏—Å–ª—è–µ–º —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è —Å —É—á–µ—Ç–æ–º —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ —Ç–∞–π–º–µ—Ä–∞
        let currentTime = task.time;
        if (task.isRunning && task.startTime) {
          const elapsed = Math.floor((Date.now() - task.startTime) / 1000);
          currentTime = task.time + elapsed;
        }

        const taskElement = document.querySelector(`[data-task-id="${taskId}"] .task-time`);
        if (taskElement) {
          taskElement.textContent = formatTime(currentTime);
        }
        // –û–±–Ω–æ–≤–ª—è–µ–º –±–ª–æ–∫ –ø–ª–∞—Ç–µ–∂–µ–π –ø–æ —Ç–∞–π–º–µ—Ä–∞–º
        renderTimerPayments();
        updatePaymentStats();
      }

      // –£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏
      async function deleteTask(taskId) {
        const confirmed = await showConfirmModal('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É –∑–∞–¥–∞—á—É?');
        if (confirmed) {
          const task = tasks.find((t) => t.id === taskId);
          if (!task) return;

          // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ç–∞–π–º–µ—Ä–∞
          if (timers[taskId]) {
            clearInterval(timers[taskId]);
            delete timers[taskId];
          }

          // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö –ø–æ–¥—Ç–∞–π–º–µ—Ä–æ–≤
          if (task.subtimers) {
            task.subtimers.forEach((subtimer) => {
              const timerKey = `${taskId}_${subtimer.id}`;
              if (timers[timerKey]) {
                clearInterval(timers[timerKey]);
                delete timers[timerKey];
              }
            });
          }

          tasks = tasks.filter((t) => t.id !== taskId);
          await autoSaveTasks();
          renderTasks();
          renderTimerPayments();
          updatePaymentStats();
        }
      }

      // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥—Ç–∞–π–º–µ—Ä–∞
      async function addSubtimer(taskId) {
        const task = tasks.find((t) => t.id === taskId);
        if (!task) return;

        const subtimerName = await showInputModal('–î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥—Ç–∞–π–º–µ—Ä', '–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–æ–¥—Ç–∞–π–º–µ—Ä–∞', '');
        if (!subtimerName || !subtimerName.trim()) return;

        if (!task.subtimers) {
          task.subtimers = [];
        }

        const newSubtimer = {
          id: Date.now() + Math.random(),
          name: subtimerName.trim(),
          time: 0,
          isRunning: false,
        };

        task.subtimers.push(newSubtimer);
        await autoSaveTasks();
        renderTasks();
        renderTimerPayments();
        updatePaymentStats();
      }

      // –ó–∞–ø—É—Å–∫/–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ–¥—Ç–∞–π–º–µ—Ä–∞
      async function toggleSubtimer(taskId, subtimerId) {
        const task = tasks.find((t) => t.id === taskId);
        if (!task || !task.subtimers) return;

        const subtimer = task.subtimers.find((st) => st.id === subtimerId);
        if (!subtimer) return;

        const timerKey = `${taskId}_${subtimerId}`;

        if (subtimer.isRunning) {
          // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ–¥—Ç–∞–π–º–µ—Ä–∞ - –≤—ã—á–∏—Å–ª—è–µ–º –ø—Ä–æ—à–µ–¥—à–µ–µ –≤—Ä–µ–º—è –∏ –¥–æ–±–∞–≤–ª—è–µ–º –∫ –æ–±—â–µ–º—É
          subtimer.isRunning = false;
          if (subtimer.startTime) {
            const elapsed = Math.floor((Date.now() - subtimer.startTime) / 1000);
            subtimer.time += elapsed;
            delete subtimer.startTime; // –£–¥–∞–ª—è–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é –º–µ—Ç–∫—É
          }
          if (timers[timerKey]) {
            clearInterval(timers[timerKey]);
            delete timers[timerKey];
          }
        } else {
          // –ó–∞–ø—É—Å–∫ –ø–æ–¥—Ç–∞–π–º–µ—Ä–∞ - —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é –º–µ—Ç–∫—É —Å—Ç–∞—Ä—Ç–∞
          subtimer.isRunning = true;
          subtimer.startTime = Date.now(); // –ó–∞–ø–æ–º–∏–Ω–∞–µ–º –≤—Ä–µ–º—è —Å—Ç–∞—Ä—Ç–∞
          
          // setInterval –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è UI
          timers[timerKey] = setInterval(() => {
            updateSubtimerTime(taskId, subtimerId);
          }, 1000);
        }

        await autoSaveTasks();
        renderTasks();
        renderTimerPayments();
        updatePaymentStats();
      }

      // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –ø–æ–¥—Ç–∞–π–º–µ—Ä–∞
      function updateSubtimerTime(taskId, subtimerId) {
        const task = tasks.find((t) => t.id === taskId);
        if (!task || !task.subtimers) return;

        const subtimer = task.subtimers.find((st) => st.id === subtimerId);
        if (!subtimer) return;

        // –í—ã—á–∏—Å–ª—è–µ–º —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è —Å —É—á–µ—Ç–æ–º —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ –ø–æ–¥—Ç–∞–π–º–µ—Ä–∞
        let currentTime = subtimer.time;
        if (subtimer.isRunning && subtimer.startTime) {
          const elapsed = Math.floor((Date.now() - subtimer.startTime) / 1000);
          currentTime = subtimer.time + elapsed;
        }

        const subtimerElement = document.querySelector(`[data-task-id="${taskId}"] [data-subtimer-id="${subtimerId}"] .subtimer-time`);
        if (subtimerElement) {
          subtimerElement.textContent = formatTime(currentTime);
        }
        // –û–±–Ω–æ–≤–ª—è–µ–º –±–ª–æ–∫ –ø–ª–∞—Ç–µ–∂–µ–π –ø–æ —Ç–∞–π–º–µ—Ä–∞–º –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ–¥—Ç–∞–π–º–µ—Ä–∞
        renderTimerPayments();
        updatePaymentStats();
      }

      // –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–¥—Ç–∞–π–º–µ—Ä–∞
      async function deleteSubtimer(taskId, subtimerId) {
        const confirmed = await showConfirmModal('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –ø–æ–¥—Ç–∞–π–º–µ—Ä?');
        if (!confirmed) return;

        const task = tasks.find((t) => t.id === taskId);
        if (!task || !task.subtimers) return;

        // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–∞–π–º–µ—Ä–∞, –µ—Å–ª–∏ –æ–Ω –∑–∞–ø—É—â–µ–Ω
        const timerKey = `${taskId}_${subtimerId}`;
        if (timers[timerKey]) {
          clearInterval(timers[timerKey]);
          delete timers[timerKey];
        }

        task.subtimers = task.subtimers.filter((st) => st.id !== subtimerId);
        await autoSaveTasks();
        renderTasks();
        renderTimerPayments();
        updatePaymentStats();
      }

      // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Å–ø–∏—Å–∫–∞ –∑–∞–¥–∞—á
      function renderTasks() {
        const tasksList = document.getElementById('tasksList');

        if (tasks.length === 0) {
          tasksList.innerHTML = '<div class="empty-state">–ü–æ–∫–∞ –Ω–µ—Ç –∑–∞–¥–∞—á. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—É—é –∑–∞–¥–∞—á—É!</div>';
          return;
        }

        tasksList.innerHTML = tasks
          .map((task) => {
            const subtimersHtml =
              task.subtimers && task.subtimers.length > 0
                ? `
          <div class="subtimers-section">
            <div class="subtimers-header">
              <div class="subtimers-title">–ü–æ–¥—Ç–∞–π–º–µ—Ä—ã:</div>
              <button class="btn-add-subtimer" onclick="addSubtimer(${task.id})">
                + –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥—Ç–∞–π–º–µ—Ä
              </button>
            </div>
            <div class="subtimers-list">
              ${task.subtimers
                .map(
                  (subtimer) => `
              <div class="subtimer-item" data-subtimer-id="${subtimer.id}">
                <div class="subtimer-info">
                  <div class="subtimer-name">${escapeHtml(subtimer.name)}</div>
                  <div class="subtimer-time">${formatTime(subtimer.time)}</div>
                  <button 
                    class="btn-add-subtimer" 
                    onclick="editSubtimerTime(${task.id}, ${subtimer.id})"
                    style="padding: 4px 8px; font-size: 11px; margin-top: 5px"
                  >
                    ‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å
                  </button>
                </div>
                <div class="subtimer-actions">
                  <button 
                    class="subtimer-btn ${subtimer.isRunning ? 'btn-stop' : 'btn-start'}" 
                    onclick="toggleSubtimer(${task.id}, ${subtimer.id})"
                  >
                    ${subtimer.isRunning ? '‚è∏' : '‚ñ∂'}
                  </button>
                  <button 
                    class="subtimer-btn btn-delete" 
                    onclick="deleteSubtimer(${task.id}, ${subtimer.id})"
                  >
                    üóë
                  </button>
                </div>
              </div>
              `,
                )
                .join('')}
            </div>
          </div>
        `
                : `
          <div class="subtimers-section">
            <div class="subtimers-header">
              <div class="subtimers-title">–ü–æ–¥—Ç–∞–π–º–µ—Ä—ã:</div>
              <button class="btn-add-subtimer" onclick="addSubtimer(${task.id})">
                + –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥—Ç–∞–π–º–µ—Ä
              </button>
            </div>
          </div>
        `;

            return `
          <div class="task-item" data-task-id="${task.id}">
            <div class="task-header">
              <div class="task-main-info">
                <div class="task-name">${escapeHtml(task.name)}</div>
                <div style="display: flex; gap: 20px; align-items: center; margin-top: 5px">
                  <div class="task-time">${formatTime(task.time)}</div>
                  <button 
                    class="btn-add-subtimer" 
                    onclick="editTaskTime(${task.id})"
                    style="padding: 6px 12px; font-size: 12px"
                  >
                    ‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å –≤—Ä–µ–º—è
                  </button>
                </div>
              </div>
              <div class="task-actions">
                <button 
                  class="${task.isRunning ? 'btn-stop' : 'btn-start'}" 
                  onclick="toggleTimer(${task.id})"
                >
                  ${task.isRunning ? '‚è∏ –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å' : '‚ñ∂ –ó–∞–ø—É—Å—Ç–∏—Ç—å'}
                </button>
                <button class="btn-delete" onclick="deleteTask(${task.id})">
                  üóë –£–¥–∞–ª–∏—Ç—å
                </button>
              </div>
            </div>
            ${subtimersHtml}
          </div>
        `;
          })
          .join('');
      }

      // –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ HTML –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
      function escapeHtml(text) {
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
      }

      // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–π–º–µ—Ä–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
      function restoreTimers() {
        tasks.forEach((task) => {
          // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–∞–π–º–µ—Ä —Å —É—á–µ—Ç–æ–º –ø—Ä–æ—à–µ–¥—à–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
          if (task.isRunning && task.startTime) {
            const elapsed = Math.floor((Date.now() - task.startTime) / 1000);
            task.time += elapsed;
            task.startTime = Date.now(); // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é –º–µ—Ç–∫—É
            
            // –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–π–º–µ—Ä –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è UI
            timers[task.id] = setInterval(() => {
              updateTaskTime(task.id);
            }, 1000);
          }
          
          // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Å–µ –ø–æ–¥—Ç–∞–π–º–µ—Ä—ã —Å —É—á–µ—Ç–æ–º –ø—Ä–æ—à–µ–¥—à–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
          if (task.subtimers) {
            task.subtimers.forEach((subtimer) => {
              if (subtimer.isRunning && subtimer.startTime) {
                const elapsed = Math.floor((Date.now() - subtimer.startTime) / 1000);
                subtimer.time += elapsed;
                subtimer.startTime = Date.now(); // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é –º–µ—Ç–∫—É
                
                // –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º –ø–æ–¥—Ç–∞–π–º–µ—Ä –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è UI
                const timerKey = `${task.id}_${subtimer.id}`;
                timers[timerKey] = setInterval(() => {
                  updateSubtimerTime(task.id, subtimer.id);
                }, 1000);
              }
            });
          }
        });
        autoSaveTasks();
      }

      // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
      document.getElementById('addTaskBtn').addEventListener('click', addTask);
      document.getElementById('settingsBtn').addEventListener('click', showSettings);
      document.getElementById('reloadBtn').addEventListener('click', async () => {
        const loaded = await loadTasksFromGitHub();
        if (loaded) {
          showSaveStatus('‚úì –î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã –∏–∑ GitHub');
        } else {
          showSaveStatus('‚úó –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ', true);
        }
      });
      document.getElementById('saveSettingsBtn').addEventListener('click', saveSettingsAndClose);
      document.getElementById('cancelSettingsBtn').addEventListener('click', hideSettings);

      // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ
      document.getElementById('settingsModal').addEventListener('click', (e) => {
        if (e.target.id === 'settingsModal') {
          hideSettings();
        }
      });

      document.getElementById('taskInput').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
          addTask();
        }
      });

      // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –±–ª–æ–∫–∞ –æ–ø–ª–∞—Ç—ã
      document.getElementById('saveRateBtn').addEventListener('click', () => {
        ratePerHour = parseInt(document.getElementById('ratePerHour').value) || 1000;
        saveSettings();
        renderTasks();
        renderTimerPayments();
        updatePaymentStats();
      });

      document.getElementById('savePaymentBtn').addEventListener('click', addAdditionalPayment);
      document.getElementById('cancelPaymentBtn').addEventListener('click', hideAddPaymentModal);

      // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–ª–∞—Ç–µ–∂–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ
      document.getElementById('addPaymentModal').addEventListener('click', (e) => {
        if (e.target.id === 'addPaymentModal') {
          hideAddPaymentModal();
        }
      });

      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
      loadSettings();
      loadPaymentSettings();
      fetchUSDTRate();
      loadTasksOnInit();
      updateFileStatus();
      renderAdditionalPayments();
      renderTimerPayments();
      renderArchive();
      updatePaymentStats();
      renderMonthlyStats();
    </script>
  </body>
</html>
